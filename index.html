<script>
        const sheetID = '1oXMJw-h2OwsK37dSOf8vAg7NW6zkEp8yJ6GFkihExD8'; 
        
        // --- CAMBIA ESTO SI TU PESTAÑA SE LLAMA 'Sheet1' ---
        const tabName = 'Sheet1'; 
        // ---------------------------------------------------

        const endpoint = `https://opensheet.elk.sh/${sheetID}/${tabName}`;

        async function cargarTienda() {
            const contenedor = document.getElementById('contenedor-productos');
            
            try {
                const respuesta = await fetch(endpoint);
                
                // Si la respuesta no es OK, lanzamos error para ver qué pasó
                if (!respuesta.ok) {
                    const errorMsg = await respuesta.text();
                    throw new Error(`Error del servidor: ${respuesta.status} - ${errorMsg}`);
                }
                
                const productos = await respuesta.json();

                // Validación extra: Si devuelve un error tipo JSON
                if (productos.error) {
                    throw new Error(`Error de la API: ${productos.error}`);
                }

                contenedor.innerHTML = ''; 

                productos.forEach(producto => {
                    // Evitar filas vacías (como las que vi en tu captura con solo .jpg)
                    if(!producto.NOMBRE) return;

                    let estadoHTML = `<p class="disponible">${producto.DISPONIBILIDAD || ''}</p>`;
                    if(producto.DISPONIBILIDAD && producto.DISPONIBILIDAD.toUpperCase() === 'AGOTADO') {
                        estadoHTML = `<p class="agotado">AGOTADO</p>`;
                    }

                    const tarjeta = `
                        <div class="producto">
                            <img src="${producto['NOMBRE IMG']}" alt="${producto.NOMBRE}" onerror="this.src='https://via.placeholder.com/250?text=Sin+Foto'">
                            <h3>${producto.NOMBRE}</h3>
                            <p>${producto.DESCRIPCION || ''}</p>
                            <p class="precio">$${producto.PRECIO}</p>
                            ${estadoHTML}
                        </div>
                    `;
                    contenedor.innerHTML += tarjeta;
                });
                
            } catch (error) {
                console.error(error);
                // Esto mostrará el error técnico en la página para que sepamos qué arreglar
                contenedor.innerHTML = `
                    <div style="color:red; text-align:center; padding:20px; border:2px dashed red;">
                        <h3>⚠️ Ocurrió un error</h3>
                        <p>Asegurate de que:</p>
                        <ul style="text-align:left; display:inline-block;">
                            <li>El archivo en Google Sheets está compartido como "Cualquier persona con el enlace".</li>
                            <li>El nombre de la pestaña en el código ('${tabName}') es IDÉNTICO al de abajo a la izquierda en tu Excel.</li>
                        </ul>
                        <p><strong>Detalle técnico:</strong> ${error.message}</p>
                    </div>`;
            }
        }

        cargarTienda();
    </script>

